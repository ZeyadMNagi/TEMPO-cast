[build]
  # This is the directory Netlify will serve your static files from.
  publish = "public"
  # This is the directory where your serverless function is located.
  functions = "functions"

[functions]
  # Enable background functions for better performance
  node_bundler = "esbuild"
  # Increase function timeout for GEMS API calls
  "*" = { timeout = 30 }

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/api/:splat"
  status = 200

# Cache GEMS images at CDN level
[[headers]]
  for = "/api/gems/*/image"
  [headers.values]
    Cache-Control = "public, max-age=3600, s-maxage=3600"
    
# Cache other API responses briefly
[[headers]]
  for = "/api/data"
  [headers.values]
    Cache-Control = "public, max-age=300, s-maxage=300"

[[headers]]
  for = "/api/complete"
  [headers.values]
    Cache-Control = "public, max-age=300, s-maxage=300"